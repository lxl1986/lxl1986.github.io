<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>key? key! | Just Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="偷偷摸摸看了阮一峰的数字签名是什么？，评论也都很精彩。小弟也来凑凑热闹，蹭蹭热度。说一下自己的理解，各位尽情可喷。 心中纵有千般疑问，也只能埋在心里。（搞不定数学啊！这里不谈数学，数学太他么难了。） 我觉得要一个一个问题来说。 私钥与公钥这个我也不懂，我又不懂数学，我只会用程序生成。不过不要紧，只需记得它俩天生一对就行了。啥意思？假设有 【私钥A、公钥A】 和 【私钥B、公钥B】，还有一个字节串（">
<meta name="keywords" content="cryptography">
<meta property="og:type" content="article">
<meta property="og:title" content="key? key!">
<meta property="og:url" content="https://lxl1986.github.io/2019/01/03/key-key/index.html">
<meta property="og:site_name" content="Just Blog">
<meta property="og:description" content="偷偷摸摸看了阮一峰的数字签名是什么？，评论也都很精彩。小弟也来凑凑热闹，蹭蹭热度。说一下自己的理解，各位尽情可喷。 心中纵有千般疑问，也只能埋在心里。（搞不定数学啊！这里不谈数学，数学太他么难了。） 我觉得要一个一个问题来说。 私钥与公钥这个我也不懂，我又不懂数学，我只会用程序生成。不过不要紧，只需记得它俩天生一对就行了。啥意思？假设有 【私钥A、公钥A】 和 【私钥B、公钥B】，还有一个字节串（">
<meta property="og:locale" content="zh">
<meta property="og:updated_time" content="2019-01-04T03:27:18.292Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="key? key!">
<meta name="twitter:description" content="偷偷摸摸看了阮一峰的数字签名是什么？，评论也都很精彩。小弟也来凑凑热闹，蹭蹭热度。说一下自己的理解，各位尽情可喷。 心中纵有千般疑问，也只能埋在心里。（搞不定数学啊！这里不谈数学，数学太他么难了。） 我觉得要一个一个问题来说。 私钥与公钥这个我也不懂，我又不懂数学，我只会用程序生成。不过不要紧，只需记得它俩天生一对就行了。啥意思？假设有 【私钥A、公钥A】 和 【私钥B、公钥B】，还有一个字节串（">
  
    <link rel="alternate" href="/atom.xml" title="Just Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Just Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">None</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://lxl1986.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-key-key" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/03/key-key/" class="article-date">
  <time datetime="2019-01-03T02:25:58.000Z" itemprop="datePublished">2019-01-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      key? key!
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>偷偷摸摸看了阮一峰的<a href="http://www.ruanyifeng.com/blog/2011/08/what_is_a_digital_signature.html" target="_blank" rel="noopener">数字签名是什么？</a>，评论也都很精彩。小弟也来凑凑热闹，蹭蹭热度。说一下自己的理解，各位尽情可喷。</p>
<p>心中纵有千般疑问，也只能埋在心里。（搞不定数学啊！这里不谈数学，数学太他么难了。）</p>
<p>我觉得要一个一个问题来说。</p>
<h2 id="私钥与公钥"><a href="#私钥与公钥" class="headerlink" title="私钥与公钥"></a>私钥与公钥</h2><p>这个我也不懂，我又不懂数学，我只会用程序生成。不过不要紧，只需记得<strong>它俩天生一对</strong>就行了。啥意思？假设有 【私钥A、公钥A】 和 【私钥B、公钥B】，还有一个字节串（文本文件，二进制文件都是字节串），如果我用 <em>私钥A</em> 加密一下，那么就只能用 <em>公钥A</em> 解密；用 <em>公钥A</em> 加密一下，也只能用 <em>私钥A</em> 解密。不关B什么鸟事。也不知道RSA钥匙空间是个啥情况？我就假设 钥匙对 的唯一性，只有配对才能互解；而这也是为啥可以加密，为啥可以签名的基石。</p>
<p>这里，还有几点说下。</p>
<ul>
<li>什么叫加密，解密？</li>
</ul>
<p>加密就是换了一个形式，解密就是还原。举个栗子，伪代码，<code>RSA_encrypt(bytes, 私钥A) ==&gt; bytes&#39;, RSA_decrypt(bytes&#39;, 公钥A) ==&gt; bytes</code> 。注意，这里加密解密都是用 RSA 相关函数。特别注意 <code>RSA_decrypt(bytes&#39;, 公钥B)</code> 会出错（据说是满足不了一个数学条件）。还有，某些人会用 <code>XXX_decrypt(bytes&#39;, 钥匙C) ==&gt; bytes&#39;&#39;</code> 这个嘛，大哥，我们用的是 RSA，你这个 <code>bytes&#39;&#39;</code>还不如我手动打开 <code>bytes&#39;</code> 在后面添加字节 <code>xxoo</code>，就好像是 <code>decrypt(byptes&#39;, &#39;xxoo&#39;) ==&gt; bytes&#39;&#39;&#39;</code>，我这是手动解密啊，哈哈。不知道说清楚没有？就是说我用RSA的算法加密了一个文件，你却用凯撒算法<strong>“解密”</strong>了一个新文件，说：“我解密了”。字节串变换字节串嘛。我上去就是一脚。</p>
<ul>
<li>公私有何区别？</li>
</ul>
<p>私钥与公钥作为天造地设的一对，互相可解。看起来没啥区别啊！假如有一钥匙对，一个拿给你，一个拿给我。你加密，我就能解密；我加密，你也能解密。这不是公私不分嘛！其实这个钥匙对中，公私是分明的，你可以自己生成一对，打开看看它们的文本表示，私钥长得多，还可对私钥设置口令。有一个细节是，私钥与公钥加密、解密所用的函数都是不同的，大概 <code>RSA_public_encrypt, RSA_private_decrypt； RSA_private_encrypt, RSA_public_decrypt</code> （上一条的伪代码还是有些瑕疵。）所以，你要是把 私钥 当 公钥 分发出去，自己却留着 公钥 当 私钥，那么就会错误百出。只是，仅仅谈 加解密 这点，公私作用是一样的。</p>
<ul>
<li>丢了怎么办？</li>
</ul>
<p>私钥丢失，比如说你唯一的电脑被儿子弄坏，修不好。恭喜你，你肯定有老婆了。只好重新生成秘钥对了。谁要是用你以前的公钥给你发密信，告诉他用新的公钥即可。</p>
<h2 id="上面扯了这么久，下面我们来谈正事。"><a href="#上面扯了这么久，下面我们来谈正事。" class="headerlink" title="上面扯了这么久，下面我们来谈正事。"></a>上面扯了这么久，下面我们来谈正事。</h2><p>原本打算搞几张图片，活跃一下气氛，表达更形象。不会弄。算了。写到这，才发现，这个话题太大了，我根本驾驭不了。只能简化了。</p>
<ul>
<li><p>加密，我要给老王的老婆发消息，怕别人知道，就用老王的老婆的公钥加密一下，别人拿到也没用，老王的老婆拿到后，用她自己的私钥解密就行了。由此，可以看到，我想发密信给谁，用他的公钥加密后，再发，就比较放心了。</p>
</li>
<li><p>签名，我先用老王的老婆的公钥把消息加密，然后我再用我的私钥加密一次。其他人拿到后，只能用我的公钥解开，大家一看，“哦，这是小李发出来的”，但是看不到我的原文；老王的老婆用我的公钥解密了，心里乐开了花，的确是小李发的，然后用她的私钥再解一次，就能看到内容了。或者，我先用我的私钥加密一次，再用老王的老婆的公钥加密一次，发出去。别人打不开，老王的老婆用私钥解密，再用我的公钥解密，“哦，是小李发来的”。在这里，我的私钥作用就是签名，确实是我（即使不是我，也是我的那个私钥）发出来的消息。实际不是这么用的，一般都是签在摘要上面。</p>
</li>
<li><p>完整性，这里也提一提，毕竟还是容易混淆。想象这样一个场景，我发了 [str, hash(str)]，你收到了，然后自己对str进行了hash，发现没错，那么str就是完整的；即使哪个2B截获了，改成[str’, hash(str’)]，再发给你，你收到了，然后自己对str’进行了hash，还是没错，那么str’就是完整的。哈哈，这就是完整性。但是，情况不是这样的，坏就坏在，我像个傻逼一样，不该把 hash值发给你。我就发个 str给你，你算完hash，打电话（假定电话安全）和我核对一下。这里你可能要问，为啥不加密？因为我仅仅想说一下完整性这个概念，不想谈及安全。就比如，你昨天写了点字符串，你就可以算一个hash值，记在纸上；今天你想看看是不是完整的，有没有被改动，就再对它hash一下，和昨天的纸上记载的对比一下。当在网络上传输的时候，情况就开始复杂了。完整性本来是需要保存正本，然后副本来和正本一一对比；不过那样代价太大了，而hash，比如sha1提供了足够的可靠性，并且效率高啊，所以就用hash值来比较。</p>
</li>
</ul>
<p>可以完全不提人，就画很多的钥匙对，概念可能更准确。但是实际钥匙都是个人或者机构持有的，所以就说成了谁的私钥，谁的公钥。比如 私钥<sub>小明</sub> 和 公钥<sub>小明</sub> 是一对的，如果某天 私钥<sub>小明</sub> 落入到了 大锤 手里，大家可能还不知道。 钥匙确实是配对的，但所属变了。对于签名来说，用 公钥<sub>小明</sub>，解开的一定是 私钥<sub>小明</sub>，我们就认为这个是消息是小明的，没想到却是大锤发的。严谨来说，我们可以说这个消息是 私钥<sub>小明</sub> 持有者发的。不客气的说，公钥<sub>小明</sub> 解开的，就是 私钥<sub>小明</sub> 签名的。具体谁人做的，无法保证，但一般就认为是小明，不排除小明给她老婆共享了 私钥<sub>小明</sub>。</p>
<p>上面简介了三个概念，不过都很理想；当进入到现实的时候，很多问题就要考虑了。首要考虑安全，安全第一嘛！私钥的安全就要靠你自己了。别人要是把刀驾到你的脖子上，那也保不住了。我们只考虑公钥的安全。</p>
<h2 id="理想与现实"><a href="#理想与现实" class="headerlink" title="理想与现实"></a>理想与现实</h2><p>我们也只考虑网络传输（你驱车万里送一个文件，或者通过安全电话一个字节一个字节口读1G的文件给对方，也当我啥也没说）。</p>
<p>我们假设老王是不敢威胁他老婆的，她老婆的私钥是安全的，只有她自己持有。也就是假设每个人的私钥是安全的（如果你被控制人身自由，电脑被控制，身不由己，就当我啥也没说，你也别往下看了；凡事都要满足一定的条件才能成立）。</p>
<p>（TMD，编不下去了）</p>
<p>你拿到了C的公钥，那就一定是C的公钥吗？</p>
<h1 id="未完待续"><a href="#未完待续" class="headerlink" title="未完待续"></a>未完待续</h1>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://lxl1986.github.io/2019/01/03/key-key/" data-id="cjqhh5ou20003fwv9eug0w2mg" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cryptography/">cryptography</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2018/12/28/nginx-proxy/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">nginx proxy</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/execution-context/">execution context</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/prototype/">prototype</a></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cryptography/">cryptography</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/height/">height</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/selector/">selector</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/server/">server</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssh/">ssh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/viewport/">viewport</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/不知所云/">不知所云</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/JavaScript/" style="font-size: 20px;">JavaScript</a> <a href="/tags/cryptography/" style="font-size: 10px;">cryptography</a> <a href="/tags/css/" style="font-size: 16.67px;">css</a> <a href="/tags/height/" style="font-size: 10px;">height</a> <a href="/tags/selector/" style="font-size: 10px;">selector</a> <a href="/tags/server/" style="font-size: 10px;">server</a> <a href="/tags/ssh/" style="font-size: 10px;">ssh</a> <a href="/tags/viewport/" style="font-size: 10px;">viewport</a> <a href="/tags/不知所云/" style="font-size: 13.33px;">不知所云</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/01/03/key-key/">key? key!</a>
          </li>
        
          <li>
            <a href="/2018/12/28/nginx-proxy/">nginx proxy</a>
          </li>
        
          <li>
            <a href="/2018/12/24/notes-on-async-await/">notes on async/await</a>
          </li>
        
          <li>
            <a href="/2018/12/21/sync-and-async/">sync-and-async</a>
          </li>
        
          <li>
            <a href="/2018/12/21/ssh/">ssh</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 李小利<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>